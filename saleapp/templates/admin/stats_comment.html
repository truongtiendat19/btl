{% extends 'admin/base_admin.html' %}
{% block page_title %}Thống kê bình luận khách hàng{% endblock %}

{% block content %}
<div class="container py-4">

    <!-- Bộ lọc khoảng thời gian -->
    <form method="get" class="mb-4">
        <label>Khoảng thời gian:</label>
        <select name="days" onchange="this.form.submit()">
            <option value="7" {% if days==7 %}selected{% endif %}>7 ngày</option>
            <option value="30" {% if days==30 %}selected{% endif %}>30 ngày</option>
            <option value="90" {% if days==90 %}selected{% endif %}>90 ngày</option>
        </select>
    </form>

    <!-- Danh sách bình luận mới nhất -->
    <h5 class="mb-3">Bình luận mới nhất</h5>
    <div class="table-responsive mb-4">
        <table class="table table-bordered table-sm align-middle text-center">
            <thead>
            <tr>
                <th>STT</th>
                <th>Ngày</th>
                <th>Khách hàng</th>
                <th>Sách</th>
                <th>Đánh giá</th>
                <th>Bình luận</th>
            </tr>
            </thead>
            <tbody>
            {% for c in latest_comments %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ c.created_date.strftime('%d/%m/%Y %H:%M') }}</td>
                <td>{{ c.user.name }}</td>
                <td>{{ c.book.name }}</td>
                <td>
                    {% for i in range(1, 6) %}
                    {% if i <= c.rating %}
                    ⭐
                    {% else %}
                    ☆
                    {% endif %}
                    {% endfor %}
                    ({{ c.rating }}/5)
                </td>
                <td style="text-align:left">{{ c.comment }}</td>
            </tr>
            {% else %}
            <tr><td colspan="6">Không có bình luận nào.</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

</div>
{% endblock %}
